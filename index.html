<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§–∞—Ä–º–∞–∫–æ–ª–æ–≥–∏—è –≤ –ø–æ–ª–µ–≤—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö v2.0</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a3a52">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üè•</text></svg>">
</head>
<body>
    <div id="app">
        <!-- HEADER -->
        <header class="header">
            <h1>üè• –ü–æ–ª–µ–≤–∞—è –º–µ–¥–∏—Ü–∏–Ω–∞</h1>
            <div class="user-info">
                <span id="userName">–ö—É—Ä—Å–∞–Ω—Ç</span>
                <span class="sync-status" id="syncStatus">üîÑ</span>
            </div>
        </header>

        <!-- NAVIGATION -->
        <nav class="navigation">
            <button onclick="showSection('menu')" class="nav-btn active" data-section="menu">üè†</button>
            <button onclick="showSection('test')" class="nav-btn" data-section="test">üìù</button>
            <button onclick="showSection('cards')" class="nav-btn" data-section="cards">üíä</button>
            <button onclick="showSection('cases')" class="nav-btn" data-section="cases">üéÆ</button>
            <button onclick="showSection('')" class="nav-btn" data-section="progress">üìä</button>
        </nav>

        <!-- LOADING -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
        </div>

        <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
        <section id="menu" class="section active">
            <div class="menu-grid">
                <div class="menu-card" onclick="showSection('test')">
                    <div class="menu-icon">üìù</div>
                    <h3>–¢–ï–°–¢–´</h3>
                    <p>–í–æ–ø—Ä–æ—Å—ã —Å –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è–º–∏ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏—Ö —Å–ª—É—á–∞–µ–≤</p>
                </div>
                
                <div class="menu-card" onclick="showSection('cards')">
                    <div class="menu-icon">üíä</div>
                    <h3>–ü–†–ï–ü–ê–†–ê–¢–´</h3>
                    <p>–§–ª—ç—à-–∫–∞—Ä—Ç—ã —Å —Ñ–æ—Ç–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤</p>
                </div>
                
                <div class="menu-card featured" onclick="showSection('cases')">
                    <div class="menu-icon">üéÆ</div>
                    <h3>–ö–ï–ô–°–´</h3>
                    <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</p>
                    <span class="badge">RPG</span>
                </div>
                
                <div class="menu-card" onclick="showSection('progress')">
                    <div class="menu-icon">üìä</div>
                    <h3>–ü–†–û–ì–†–ï–°–°</h3>
                    <p>–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è</p>
                </div>
            </div>
            
            <div class="update-info">
                <p>üì° –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="lastUpdate">--</span></p>
                <button onclick="syncData()" class="btn btn-small">üîÑ –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button>
            </div>
        </section>

        <!-- –ú–û–î–£–õ–¨ –¢–ï–°–¢–û–í –° –ö–ê–†–¢–ò–ù–ö–ê–ú–ò -->
        <section id="test" class="section">
            <div class="test-container">
                <div class="test-header">
                    <span>–í–æ–ø—Ä–æ—Å <strong id="questionNum">1</strong>/<span id="totalQuestions">20</span></span>
                    <span class="score">‚úì <span id="correctCount">0</span></span>
                </div>
                
                <!-- –ö–∞—Ä—Ç–∏–Ω–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ -->
                <div class="question-image-container" id="questionImageContainer">
                    <img id="questionImage" src="" alt="–ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–π —Å–ª—É—á–∞–π">
                    <button class="zoom-btn" onclick="zoomImage()">üîç</button>
                </div>
                
                <div class="question-text" id="questionText">
                    –ó–∞–≥—Ä—É–∑–∫–∞...
                </div>
                
                <div class="answers" id="answersContainer"></div>
                
                <div class="explanation" id="explanation"></div>
                
                <div class="test-controls">
                    <button onclick="checkTestAnswer()" class="btn btn-primary" id="checkBtn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
                    <button onclick="nextTestQuestion()" class="btn btn-secondary" id="nextBtn">–î–∞–ª–µ–µ ‚Üí</button>
                </div>
            </div>
        </section>

        <!-- –ú–û–î–£–õ–¨ –§–õ–≠–®-–ö–ê–†–¢ –° –ò–õ–õ–Æ–°–¢–†–ê–¶–ò–Ø–ú–ò -->
<section id="cards" class="section">
    <div class="cards-header">
        <h2>üíä –ü—Ä–µ–ø–∞—Ä–∞—Ç—ã –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</h2>
        <div class="cards-filters">
            <select id="categoryFilter" onchange="filterCards()">
                <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                <option value="–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏">–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏</option>
                <option value="–ê–Ω–∞–ª—å–≥–µ—Ç–∏–∫–∏">–ê–Ω–∞–ª—å–≥–µ—Ç–∏–∫–∏</option>
                <option value="–ê–Ω—Ç–∏–¥–æ—Ç—ã">–ê–Ω—Ç–∏–¥–æ—Ç—ã</option>
                <option value="–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ">–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ</option>
                <option value="–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</option>
                <option value="–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏">–†–∞—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</option>
            </select>
            <div class="view-toggle">
                <button onclick="setCardView('single')" class="view-btn active" id="viewSingle">üìÑ</button>
                <button onclick="setCardView('grid')" class="view-btn" id="viewGrid">üìä</button>
            </div>
        </div>
    </div>
    
    <!-- –†–µ–∂–∏–º –æ–¥–∏–Ω–æ—á–Ω–æ–π –∫–∞—Ä—Ç—ã -->
    <div id="singleCardView" class="single-card-view">
        <div class="flashcard-wrapper">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
                <!-- –õ–∏—Ü–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ -->
                <div class="card-side card-front" id="cardFront">
                    <div class="card-category" id="cardCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</div>
                    
                    <div class="card-image-container">
                        <img id="drugImage" src="" alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞">
                        <div class="image-placeholder" id="imagePlaceholder">
                            <span>üíä</span>
                        </div>
                    </div>
                    
                    <h3 class="card-title" id="drugName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞</h3>
                    <p class="card-subtitle" id="drugINN_front">–ú–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ</p>
                    
                    <div class="tap-hint">
                        <span class="tap-icon">üëÜ</span>
                        <span>–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π</span>
                    </div>
                </div>
                
                <!-- –û–±—Ä–∞—Ç–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ -->
                <div class="card-side card-back" id="cardBack">
                    <div class="card-back-header">
                        <h3 id="drugName_back">–ù–∞–∑–≤–∞–Ω–∏–µ</h3>
                        <span class="card-form" id="drugForm_badge">–§–æ—Ä–º–∞</span>
                    </div>
                    
                    <div class="drug-info-grid">
                        <div class="info-section">
                            <div class="info-icon">üíâ</div>
                            <div class="info-content">
                                <span class="info-label">–î–æ–∑–∏—Ä–æ–≤–∫–∞</span>
                                <span class="info-value" id="drugDosage">‚Äî</span>
                            </div>
                        </div>
                        
                        <div class="info-section">
                            <div class="info-icon">‚úÖ</div>
                            <div class="info-content">
                                <span class="info-label">–ü–æ–∫–∞–∑–∞–Ω–∏—è</span>
                                <span class="info-value" id="drugIndications">‚Äî</span>
                            </div>
                        </div>
                        
                        <div class="info-section warning">
                            <div class="info-icon">‚ö†Ô∏è</div>
                            <div class="info-content">
                                <span class="info-label">–ü—Ä–æ—Ç–∏–≤–æ–ø–æ–∫–∞–∑–∞–Ω–∏—è</span>
                                <span class="info-value" id="drugContra">‚Äî</span>
                            </div>
                        </div>
                        
                        <div class="info-section">
                            <div class="info-icon">‚ö°</div>
                            <div class="info-content">
                                <span class="info-label">–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</span>
                                <span class="info-value" id="drugSideEffects">‚Äî</span>
                            </div>
                        </div>
                        
                        <div class="info-section field-note">
                            <div class="info-icon">üèïÔ∏è</div>
                            <div class="info-content">
                                <span class="info-label">–ü–æ–ª–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</span>
                                <span class="info-value" id="drugField">‚Äî</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è -->
                    <div class="additional-images" id="additionalImages">
                        <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è -->
                    </div>
                    
                    <div class="tap-hint">
                        <span>–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
        <div class="card-controls">
            <button onclick="prevCard()" class="btn btn-icon" id="prevBtn">
                <span>‚Üê</span>
            </button>
            
            <div class="card-actions">
                <button onclick="markCard('know')" class="btn btn-success">
                    <span>‚úì</span> –ó–Ω–∞—é
                </button>
                <button onclick="markCard('dontknow')" class="btn btn-danger">
                    <span>‚úó</span> –ü–æ–≤—Ç–æ—Ä–∏—Ç—å
                </button>
            </div>
            
            <button onclick="nextCard()" class="btn btn-icon" id="nextBtn">
                <span>‚Üí</span>
            </button>
        </div>
        
        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å -->
        <div class="cards-progress">
            <div class="progress-text">
                <span id="cardIndex">1</span> / <span id="totalCards">0</span>
            </div>
            <div class="progress-bar-mini">
                <div class="progress-fill-mini" id="cardsProgressFill"></div>
            </div>
            <div class="progress-stats">
                <span class="stat-know">‚úì <span id="knowCount">0</span></span>
                <span class="stat-repeat">‚Üª <span id="repeatCount">0</span></span>
            </div>
        </div>
    </div>
    
    <!-- –†–µ–∂–∏–º —Å–µ—Ç–∫–∏ (–≥–∞–ª–µ—Ä–µ—è) -->
    <div id="gridCardView" class="grid-card-view" style="display: none;">
        <div class="cards-grid" id="cardsGrid">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
    </div>
</section>

        
        <!-- –ú–û–î–£–õ–¨ –ö–ï–ô–°–û–í (RPG) -->
        <section id="cases" class="section">
            <div class="cases-container">
                <!-- –°–ø–∏—Å–æ–∫ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ -->
                <div id="scenarioList" class="scenario-list">
                    <h2>üéÆ –ö–ª–∏–Ω–∏—á–µ—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏</h2>
                    <p>–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è:</p>
                    <div id="scenariosGrid" class="scenarios-grid"></div>
                </div>
                
                <!-- –ê–∫—Ç–∏–≤–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π -->
                <div id="activeScenario" class="active-scenario" style="display: none;">
                    <!-- –°—Ç–∞—Ç—É—Å –ø–∞—Ü–∏–µ–Ω—Ç–∞ -->
                    <div class="patient-status" id="patientStatus">
                        <div class="vital-signs">
                            <span class="vital" id="vitalBP">–ê–î: --/--</span>
                            <span class="vital" id="vitalHR">–ß–°–°: --</span>
                            <span class="vital" id="vitalState">–°–æ—Å—Ç–æ—è–Ω–∏–µ: --</span>
                        </div>
                        <div class="patient-condition" id="patientCondition">
                            <div class="condition-bar">
                                <div class="condition-fill" id="conditionFill"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- –°—Ü–µ–Ω–∞ -->
                    <div class="scene">
                        <div class="scene-image-container">
                            <img id="sceneImage" src="" alt="–°–∏—Ç—É–∞—Ü–∏—è">
                        </div>
                        
                        <div class="scene-content">
                            <h3 id="sceneTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h3>
                            <p id="sceneDescription">–û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏...</p>
                        </div>
                        
                        <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π -->
                        <div class="choices" id="choicesContainer"></div>
                        
                        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–±–æ—Ä–∞ -->
                        <div class="choice-result" id="choiceResult"></div>
                    </div>
                    
                    <!-- –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π -->
                    <div class="action-log">
                        <h4>üìã –ñ—É—Ä–Ω–∞–ª –¥–µ–π—Å—Ç–≤–∏–π:</h4>
                        <ul id="actionLog"></ul>
                    </div>
                    
                    <button onclick="exitScenario()" class="btn btn-secondary">‚Üê –í—ã–π—Ç–∏</button>
                </div>
                
                <!-- –≠–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -->
                <div id="scenarioResult" class="scenario-result" style="display: none;">
                    <div class="result-icon" id="resultIcon">üèÜ</div>
                    <h2 id="resultTitle">–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
                    <p id="resultMessage">–û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞</p>
                    <div class="result-stats" id="resultStats"></div>
                    <button onclick="restartScenario()" class="btn btn-primary">üîÑ –ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
                    <button onclick="exitScenario()" class="btn btn-secondary">‚Üê –ö —Å–ø–∏—Å–∫—É</button>
                </div>
            </div>
        </section>

        <!-- –ú–û–î–£–õ–¨ –ü–†–û–ì–†–ï–°–°–ê -->
        <section id="progress" class="section">
            <h2>üìä –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
            
            <div class="progress-grid">
                <div class="progress-card">
                    <h3>üìÖ –î–Ω–µ–π –≤ —Å—Ç—Ä–æ—é</h3>
                    <div class="stat-value" id="studyDays">1</div>
                    <p>–Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</p>
                </div>

                <div class="progress-card">
                    <h3>üìà –û–±—â–∏–π —É—Ä–æ–≤–µ–Ω—å</h3>
                    <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">--%</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="overallProgress" style="width: 0%"></div>
                    </div>
                </div>

                <div class="progress-card">
                    <h3>üìù –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤</h3>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>–ü—Ä–æ–π–¥–µ–Ω–æ:</span>
                        <strong id="testsComplete">0/20</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                        <span>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª:</span>
                        <strong id="avgScore">0%</strong>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>–õ—É—á—à–∏–π –±–∞–ª–ª:</span>
                        <strong id="bestScore">0%</strong>
                    </div>
                </div>
                
                <div class="progress-card">
                    <h3>üíä –ü–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h3>
                    <div id="categoryProgress">
                        </div>
                </div>
                
                <div class="progress-card achievements" style="grid-column: 1 / -1;">
                    <h3>üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                    <div id="achievements"></div>
                </div>
            </div>
        </section>

        <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –î–õ–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô -->
        <div id="imageModal" class="modal">
            <span class="modal-close" onclick="closeModal()">&times;</span>
            <img id="modalImage" src="">
        </div>
    </div>

    <script src="js/config.js"></script>
    <script src="fallback-data.js"></script>
    <script src="js/data-loader.js"></script>
    <script src="js/test-module.js"></script>
    <script src="js/cards-module.js"></script>
    <script src="js/cases-module.js"></script>
    <script src="js/progress-module.js"></script>
    <script src="js/app.js"></script>
</body>

</html>